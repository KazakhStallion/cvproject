<!DOCTYPE html>
<html lang="en"><head>  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>CV-Based Real-Time Poker Advisor | ECE, Virginia Tech | Fall 2025: ECE 4554/5554</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Le styles -->  
  <link href="css/bootstrap.css" rel="stylesheet">
  <style>
  body {
    padding-top: 60px; 
  }
  .vis { color: #3366CC; }
  .data { color: #FF9900; }
  </style>
  <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/style.css" />
<style>

  /* Ensure lists match body text */
  li {
    font-size: 12pt;
    line-height: 1.45;
  }

  /* Optional: make figure captions match as well */
  figcaption {
    font-size: 12pt;
    font-style: italic;
  }
</style>


</head>

<body>
<div class="container">
<div class="page-header">

  <!-- Title and Name --> 
  <h1>CV-Based Real-Time Poker Advisor</h1> 
  <span style="font-size: 20px; line-height: 1.5em;"><strong>Team Members: Tamirlan Zharmagambetov, Victor Rouzer, Jai Ravula</strong></span><br>
  <span style="font-size: 18px; line-height: 1.5em;">Fall 2025 ECE 4554/5554 Computer Vision: Course Project</span><br>
  <span style="font-size: 18px; line-height: 1.5em;">Virginia Tech</span><br>
  <span style="font-size: 18px; line-height: 1.5em;">Github Link (Source Code): <a href="https://github.com/KazakhStallion/PokerStars_Advisor">https://github.com/KazakhStallion/PokerStars_Advisor</a></span>
  <hr>

  <!-- Abstract -->
  <h3>Abstract</h3>
  <p>
    A computer-vision driven “poker-advisor” module for robust automated poker decision making tuned 
    to be utilized on the PokerStars computer application. Real-time video input from the game display is 
    continuously captured using OCR tooling and constructs a comprehensive game-state structure. Statistical analysis 
    tools provide drivers to a custom-built decision function to provide near-instantaneous action advice to the player. 
    Unlike prior implementations that require computationally expensive object detection models and decision functions based 
    on heavyweight methods such as reinforcement learning and complex AI-based game-state expansion, a lightweight OCR + fundamental 
    statistical analysis-based system is implemented. This allows the system to be run on less-powerful machines. We evaluate the 
    efficacy of the system in two distinct areas- the accuracy of the computer vision model outputs and relevant statistics after 
    Monte-Carlo simulation utilizing our decision algorithm. Experimental results demonstrate that the implementation achieves 
    near-perfect detection and game-state construction accuracy and intermediate level gameplay skill when strictly utilizing action 
    recommendations from the decision algorithm. 
  </p>


  <!-- Introduction -->
  <h2>1. Introduction</h2>
  <p>
Poker is a game of decision-making based on incomplete information that combines probabilistic reasoning and behavioral inference to exploit opponents for maximum profit. During the game, a player must evaluate their private “hole cards” in relation to the public “community cards” along with contextual factors such as position, pot size, stack depth, and opponent behavior to determine the most profitable course of action. A skilled player can evaluate all these factors almost instantly and make accurate decisions much of the time. In a highly time-sensitive version of the game in online poker, players only have 5-10 seconds to make a decision, regardless of how many chips are in the pot. Accurate identification of game state and timely computation of the optimal response are critical to achieving consistent, winning results. This tool is valuable in applications ranging from personal skill development, real-time strategy refinement, post-game analysis, and automated data collection for statistical study. <br>
The goal of this project is to design a lightweight, real-time poker advisor module tuned for use on the PokerStars desktop application. Rather than utilizing complex object detection models, the system obtains visual information utilizing the python Tesseract library for OCR-based tooling. Deterministic based parsing is used to reconstruct a structured game-state representation. Common implementations of “poker bots” utilize reinforcement learning or decision-tree based agentic training for decision making, which in both cases exponentially increase in computational resource utilization the more players and actions are factored into the game state. This, in many cases, makes it near-impossible (or at least extremely inefficient) to run on consumer grade machines. In online poker, a near-instantaneous decision must be made when the action is on a player to keep the game running quickly. The unique value proposition of our implementation is the near-perfect object detection of the OCR module paired with the strictly statistical decision-making algorithm. <br>
There are two main issues with “poker bots” currently available on the market. Options that are robust, effective, and used standardly are not open source, and require either one-time-payments or subscription. Open-source options are not real-time and/or do not contain decision making capabilities, only statistics computation. The motivation for this approach lies in two areas- Reducing the computational burden of pre-existing implementations and developing a tool ready-for-use right out of the box, not requiring training for either the CV object detection module or the decision-making algorithm, and providing an open-source option that is not currently available.
  </p>

  <!-- Approach -->
  <br>
  <h2>2. Approach/ Methodology</h2>
<h3>System Overview</h3>

<h4>The PokerStars Advisor operates as a real-time pipeline:</h4>

<ul>
  <li>Screen capture obtains a video stream of the PokerStars table.</li>
  <li>OCR subsystem interprets all table elements using predefined ROIs, OCR, and template matching.</li>
  <li>Hand evaluation computes the strength and equity of hands.</li>
  <li>Decision-making uses the evaluated game state to recommend strategy.</li>
  <li>Output formatting provides human-readable or machine-readable decision support.</li>
</ul>

<hr />

<h3>2.1 OCR Subsystem Methodology</h3>

<h4>ROI Configuration</h4>
<p>
  A JSON-based layout defines all table elements, including hero cards, five board cards, pot and total-pot text, and all seat-level regions (stack, bet, status, and card areas), along with the dealer-button location. Each entry stores x, y, width, and height coordinates relative to the table window. This modular structure maintains consistency across frames, enables rapid updates during development, and supports upcoming monitor-scaling functionality.
</p>

<h4>Screen Capture Process</h4>
<p>
  The system uses MSS to capture only the active table region, producing BGR arrays at roughly 10 FPS. The capture loop feeds frames directly into the OCR pipeline, minimizing latency and supporting real-time updates.
</p>

<figure>
  <img src="figures/figure1.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 1: Screen capture results.</figcaption>
</figure>

<h4>Tesseract OCR Workflow</h4>
<p>
  Tesseract processes all numeric and text-based UI elements such as stacks, bets, pots, player actions, and special states. The subsystem uses OEM = 1 (LSTM) and PSM = 7 (single-line), combined with grayscale conversion, 2× upscaling, and Otsu thresholding for improved clarity on small PokerStars fonts. Character whitelists are applied per-ROI to reduce noise and misreads - letters for actions, digits/monetary symbols for chip counts, and limited character sets for special statuses (“All In,” “Sitting Out”). Because PokerStars sometimes places special statuses inside the stack ROI, both the status ROI and stack ROI are OCR-processed, and special statuses detected in the stack area override standard status output.
</p>

<figure>
  <img src="figures/figure2.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 2: Tesseract OCR test frame</figcaption>
</figure>
<figure>
  <img src="figures/figure3.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 3: Tesseract OCR results</figcaption>
</figure>

<h4>Status and Action Recognition</h4>
<p>
  The system distinguishes normal actions (fold, call, bet, raise, check) from special conditions (all-in, sitting-out). Since special conditions appear only in the stack region, the pipeline fuses both text sources and resolves conflicts by prioritizing special statuses to ensure stable seat-state interpretation.
</p>

<h4>Card-Presence Detection</h4>
<p>
  Before template matching, the system evaluates pixel-intensity variance inside each card ROI. Empty regions exhibit low variance, while visible cards produce high variance. This quick check reduces false positives and avoids unnecessary templates.
</p>

<div style="display: flex; gap: 1.5rem;">
  <figure style="flex: 1; text-align: center;">
    <img src="figures/figure4.png" style="max-width: 100%; height: auto;">
    <figcaption>Figure 4: Card presence test frame</figcaption>
  </figure>

  <figure style="flex: 1; text-align: center;">
    <img src="figures/figure5.png" style="max-width: 100%; height: auto;">
    <figcaption>Figure 5: Card presence test results</figcaption>
  </figure>
</div>

<h4>Rank and Suit Recognition</h4>
<p>
  Detected card regions undergo normalized cross-correlation against grayscale rank (A–2) and suit (hearts, diamonds, clubs, spades) templates. The process includes automatic resizing to address ROI/template mismatches and light Gaussian blurring for stability.
</p>

<figure>
  <img src="figures/figure6.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 6: Rank and suit recognition results</figcaption>
</figure>

<h4>Street Determination</h4>
<p>
  The betting round is inferred solely from the number of recognized board cards: 0 (preflop), 3 (flop), 4 (turn), or 5 (river). This avoids relying on animations or text-based cues.
</p>

<h4>Dealer Button and Turn Detection</h4>
<p>
  A lightweight HSV threshold isolates the yellow dealer chip. A pixel-ratio test determines whether the region contains the button, allowing the system to identify the dealer’s seat reliably across various visual conditions. In addition, a timebar ROI was specified for the hero seat, allowing the system to understand if it’s the hero’s turn or not.
</p>
<div style="display: flex; gap: 1.5rem;">
  <figure style="flex: 1; text-align: center;">
    <img src="figures/figure7_1.png" style="width: 100%; height: auto;">
    <figcaption>Figure 7: Dealer and turn recognition (Hero’s turn).</figcaption>
  </figure>

  <figure style="flex: 1; text-align: center;">
    <img src="figures/figure7_2.png" style="width: 100%; height: auto;">
    <figcaption>Figure 7: Dealer and turn recognition (Hero’s turn)</figcaption>
  </figure>
</div>

<h4>Efficient OCR Scheduling and Frame Queuing</h4>
<p>
  To sustain real-time operation, the system avoids running full OCR on every captured frame. Instead, it uses a lightweight scheduling approach:
</p>
<ul>
  <li>full OCR executes every 2 frames</li>
  <li>intermediate frames reuse the most recent valid TableState</li>
  <li>inexpensive checks—card-presence variance and dealer-button detection—run every frame</li>
</ul>
<p>
  This reduces overall OCR workload by ~50%, prevents unnecessary Tesseract calls, and maintains smooth 10 FPS performance without sacrificing responsiveness.
</p>

<h4>Game-State Assembly</h4>
<p>
  All extracted information populates SeatState and TableState structures, forming a complete representation of the table. These unified data objects interface directly with downstream modules, enabling seamless integration with hand evaluation and decision-making components. A JSON containing the full per-street information of the game, along with the image of the street, is stored as well.
</p>

<hr />

<h3>2.2 Hand Evaluation Module Methodology</h3>

<p>
  The hand evaluation module turns the current game state into a single quantity: hero’s equity against the other active players. For each decision, we extract the hero’s two hole cards, any visible community cards, and the number of active players. These are then passed into an evaluator where the output is a scalar in [0,1] representing the hero's probability of winning or tying at showdown if the hand were played out from the current street.
</p>
<p>
  The simple_evaluator function computes this equity using a Monte Carlo simulation built on top of eval7, a poker hand evaluation and equity calculation library. For each simulation, it constructs a fresh deck, removes hero’s cards and any known board cards, deals random hole cards to the remaining players, and, if necessary, draws the remaining community cards. With a fully specified deal, it evaluates the seven-card hand for each player, compares the hand strengths to see whether the hero wins, ties, or loses that trial, and updates running counts. After repeating this process thousands of times, equity is estimated as equity = (wins+0.5×ties) / trials.
</p>
<p>
  Eval7 is responsible for the fast evaluation of individual Hold’em hands inside this loop. It represents each card as an integer with bit fields encoding rank and suit and uses precomputed lookup tables to recognize hand patterns. Given a 5–7 card hand, eval7.evaluate combines bitwise checks for flushes and straights with table lookups for rank combinations to return a single integer score, where larger values correspond to stronger hands. Crucially, this evaluation runs in effectively constant time, so we can afford to call it tens of thousands of times per decision, making the Monte Carlo equity estimates a reasonable choice for our real time application.
</p>

<figure>
  <img src="figures/figure8.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 8: Example decision layer output for a strong hand</figcaption>
</figure>

<hr />

<h3>3.3 Decision-Making Module Methodology</h3>

<p>
  The decision-making module consumes two main inputs: hero’s equity from the hand evaluation module and a small set of strategic descriptors extracted from the game state, such as hero’s position, the number of players involved, and any villain actions. It is split into separate policies for preflop and postflop (flop, turn, and river), both of which are purely rule-based and use equity thresholds instead of learned models for simplicity.
</p>
<p>
  Preflop, the policy uses hero’s equity together with position and opponent actions to decide whether to fold, call, or raise. The thresholds were calibrated using GTO Wizard: for a set of typical preflop spots we recreated similar game states in the solver, looked at which hands it continued (raise or called) with, and then computed our own equity for those hands. By matching “continue” and “fold” regions in equity space to the solver’s ranges, we obtained simple cutoffs for each scenario. The resulting strategy is raise-first-in: in unopened pots, any hand above the position-specific opening threshold is raised, and hands below it are folded; the system never limps. When facing action, equity thresholds separate folds, calls, and value 3-bets. To keep complexity manageable, we do not implement deliberate bluffing preflop and instead follow straightforward ABC poker: raises are value-oriented and ranges are simplified compared with full GTO play.
</p>
<p>
  On flop and later streets, the module first applies a “pot equity first” test before considering anything more subtle. Suppose the pot is (P) and the hero is facing a bet of size (B); calling invests (B) to potentially win a final pot of (P + 2B), so the break-even equity is (B / (P + 2B)). If the hero's raw equity is below this value, the call is mathematically unprofitable even under ideal conditions, and the system simply folds. Only when the hero's equity clears this pot-odds threshold do we consider continuing. At that point we adjust equity to reflect position and aggression: being out of position or facing very strong lines effectively reduces how much of that equity can be realized in practice, so we subtract small penalties based on who has position and how the action has unfolded to obtain an “effective” equity.
</p>
<p>
  The policy groups effective equity into a few buckets that map directly to actions. Very low equity hands go into a folding bucket: they are folded to bets and checked back when possible. Slightly stronger hands serve as bluff-catchers or thin showdown holdings, which can call normal-sized bets but rarely raise. Strong made hands and solid draws form a value bucket that usually continues, and the top bucket holds very strong and near-nut hands that prefer betting or raising for value, using simple pot- and bet-based sizing rules. As with the preflop module, the goal is not to engineer perfectly balanced bluff ranges, but to use equity, position, and opponent aggression to play a straightforward ABC style that avoids marginal calls and reserves aggression for truly strong holdings.
</p>

<figure>
  <img src="figures/figure9.png" style="max-width: 100%; height: auto;">
  <figcaption>Figure 9: GTO Wizard range calculation for BB facing a raise and call</figcaption>
</figure>


</div>
  <!-- Experiments and Results -->
  <br><br>
<h2>4. Experimental Results</h2>

<h3>4.1 OCR Accuracy</h3>
<p>
  To evaluate the effectiveness of the OCR system, we constructed a dataset of 200 labelled PokerStars gameplay frames sampled across multiple table layouts. Each frame was manually labelled for all fields of the game-state data structure that the OCR system should be recognizing.
</p>
<p>
  Figure 10 summarizes the per-field accuracy across the test set. Results indicate that numeric fields including hero stack size, pot size, total pot size achieved greater than 98% accuracy, while textual fields such as action text achieved over 96% accuracy. In testing, it was observed that misclassifications were generally a result of slight color differences in reference vs actual objects during template matching. These results confirm that the approach we took is sufficient for extraction of game state data for our use case.
</p>
<figure>
  <img src="figures/figure10.png" style="width: 70%; height: auto;">
  <figcaption>Figure 10: Per field OCR accuracy on a held-out test set of 200 labeled pokerstar frames</figcaption>
</figure>

<hr />

<h3>4.2 Game State Reconstruction</h3>
<p>
  Accurate reconstruction of the game state relies on reliable recognition of UI elements from the OCR module. Through our testing of 200 PokerStars gameplay screen captures, we evaluated 640 individual card crops of both hero and community cards.
</p>
<p>
  Figure 11 shows confusion matrices for rank and suit classification. The system correctly identifies card rank in 99% of cases and suits in 97% of cases.
</p>
<figure>
  <img src="figures/figure11.png" style="width: 70%; height: auto;">
  <figcaption>Figure 11: Confusion matrix for rank (left) and suit(right) recognition on hero and board cards using normalized cross-correlation templates</figcaption>
</figure>
<figure>
  <img src="figures/figure11_suit.png" style="width: 70%; height: auto;">
  <figcaption>Figure 11: Confusion matrix for rank (left) and suit(right) recognition on hero and board cards using normalized cross-correlation templates</figcaption>
</figure>

<hr />

<h3>4.3 Decision Layer Behavior</h3>
<p>
  To assess the quality of the algorithm’s action recommendations, we compared output from the rule-based decision layer against a reference strategy derived from GTO Wizard. For each test condition, we logged the decision agreement for fold, call, and raise actions across various stack depths, table positions, and game circumstances.
</p>
<p>
  Figure 12 displays the agreement rates grouped by street and scenario. Preflop recommendations matched the GTO baseline 78% of the time. Agreement decreased consistently through later streets (64% on the flop, 59% on the turn) due to the model’s lack of opponent range adaptation. While the system does not attempt to replicate solver outputs, the results demonstrate intermediate level decision-making performance based strictly on statistical analysis and equity thresholds.
</p>
<figure>
  <img src="figures/figure12.png" style="width: 70%; height: auto;">
  <figcaption>Figure 12: Bar chart of agreement rate with GTO wizard decisions by street/ situation</figcaption>
</figure>

<hr />

<h3>4.4 Runtime Performance</h3>
<p>
  A key motivation for the system is the ability to run in real-time on standard consumer computer hardware. We measure end-to-end processing latency, from screen capture to decision making. Figure 13 shows decision computation time as a function of the number of players. The system achieved latency of under 1s in all cases, ensuring near-instantaneous action recommendations.
</p>
<figure>
  <img src="figures/figure13.png" style="width: 70%; height: auto;">
  <figcaption>Figure 13: Line graph of # of players vs time for action decision</figcaption>
</figure>

  <!-- Conclusion -->
  <br><br>
  <h3>Conclusion</h3>
  <p>
  This report described the design and implementation of a real-time PokerStars Advisor system that uses OCR-based information extraction, statistical hand evaluation, and decision algorithm to provide real-time action reccomendations. 
  By utilizing template matching as a lightweight computer vision technique along with a rule-based decision algorithm, we demonstrated that reliable poker decision support can be achieved without
  reliance on heavyweight neural models and/or training pipelines. Experimental results indicate that the OCR system attains high accuracy and card recognition provides stable rank and suit detection. Direct comparisons
  against GTO wizard reccomendations showed that the simplified decision policy captures a substantial portion of poker solver behavior in common game situations, all while still remaining computationally inexpensive enough
  to run comfortably on consumer hardware.
  <br><br>
  While the current approach performs well, several enhancements could further improve the implementation. On the perception side, expanding the ROI layout to support multiple pokerstars themes, application types(mobile, browser), or
  even adding support for other online poker platforms would increase real-world usability. At the decision level, replacing fixed thresholds with adaptive ranges tuned towards opponent hand ranges and previous actions would
  allow for more strategic behavior. All together, these improvements represent a clear roadmap to the continous improvement of our implementation suitable for a wide range of gameplay scenarios. 
  </p>

  <!-- References -->
  <br><br>
  <h3>References</h3>
  <ul>
    <li>Tesseract OCR: <a href="https://github.com/tesseract-ocr/tesseract">https://github.com/tesseract-ocr/tesseract</a></li>
    <li>Game Theory Optimal (GTO) Poker: <a href="https://www.pokerstrategy.com/gto/">https://www.pokerstrategy.com/gto/</a></li>
    <li>Eval 7 Python Library<a href="https://pypi.org/project/eval7/">https://pypi.org/project/eval7/</a></li>
    <li>GTO Wizard<a href="https://gtowizard.com/en/">https://gtowizard.com/en/</a></li>
    <li>Poker Range References<a href = "https://openpokertools.com/">https://openpokertools.com/</a></li>
  </ul>

  <hr>
  <footer> 
    <p>© Tamirlan Zharmagambetov, Victor Rouzer, Jai Ravula</p>
  </footer>
</div>
</div>

<br><br>

</body></html>

<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
/>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
  defer
></script>

<!-- Optional: language components you need -->
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"
  defer
></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"
  defer
></script>
